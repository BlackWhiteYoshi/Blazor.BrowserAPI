# HTMLMediaElement

The *HTMLMediaElement* interface adds to HTMLElement the properties and methods needed to support basic media-related capabilities that are common to audio and video.

The [HTMLVideoElement](https://developer.mozilla.org/en-US/docs/Web/API/HTMLVideoElement) and [HTMLAudioElement](https://developer.mozilla.org/en-US/docs/Web/API/HTMLAudioElement) elements both inherit this interface.</para>


<br><br />
## Example

```razor
<audio @ref="audioElement" src="Example.mp3" preload="auto"></audio>
<button @onclick="Play">Play music</button>
```

```csharp
public sealed partial class ExampleComponent : ComponentBase, IAsyncDisposable {
    [Inject]
    public required IElementFactory ElementFactory { private get; init; }

    private ElementReference audioElement;
    private IHTMLMediaElement? audio;

    protected override void OnAfterRender(bool firstRender) {
        if (firstRender)
            audio = ElementFactory.CreateHTMLMediaElement(audioElement);
    }

    public ValueTask DisposeAsync() => audio?.DisposeAsync() ?? ValueTask.CompletedTask;


    private async Task Play() {
        await audio!.Play();
    }
}
```

**Note**: The null-forgiving operator is used in the method *Play*.
If *Play* is used for an interaction event, like a click event, this is fine, but if it is used somewhere before *OnAfterRender* is executed, a NullReferenceException will occur.


<br><br />
## Members

### IElementFactory

An instance of this class takes a *ElementReference* and exposes an interface to interact with it.

This factory **does not dispose** the created objects, they must disposed manually.
So do not forget to call DisposeAsync() on a dialog-object when you are done with it.

#### Methods

| **Name**               | **Parameters**                    | **ReturnType**      | **Description**                                                                                                                                                                                                                                                                              |
| ---------------------- | --------------------------------- | ------------------- | -------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- |
| CreateHTMLMediaElement | ElementReference htmlMediaElement | IHTMLMediaElement   | Takes a *ElementReference* of [HTMLVideoElement](https://developer.mozilla.org/en-US/docs/Web/API/HTMLVideoElement) or [HTMLAudioElement](https://developer.mozilla.org/en-US/docs/Web/API/HTMLAudioElement) and returns a *IHTMLMediaElement* interface to interact with the given element. |


<br></br>
### IHTMLMediaElement

The *HTMLMediaElement* interface adds to HTMLElement the properties and methods needed to support basic media-related capabilities that are common to audio and video.

The [HTMLVideoElement](https://developer.mozilla.org/en-US/docs/Web/API/HTMLVideoElement) and [HTMLAudioElement](https://developer.mozilla.org/en-US/docs/Web/API/HTMLAudioElement) elements both inherit this interface.

Objects of this class must disposed manually, so do not forget to call DisposeAsync() when you are done with it.

#### Properties

| **Name**                | **Type**                       | get/set | **Description**                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              |
| ----------------------- | ------------------------------ | ------- | ------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------ |
| Src                     | ValueTask&lt;string&gt;        | get     | A string that reflects the src HTML attribute, which contains the URL of a media resource to use. Note: The best way to know the URL of the media resource currently in active use in this element is to look at the value of the currentSrc attribute, which also takes into account selection of a best or preferred media resource from a list provided in an HTMLSourceElement (which represents a &lt;source&gt; element).                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              |
| SrcObject               | ValueTask&lt;IMediaStream?&gt; | get     | A MediaStream representing the media to play or that has played in the current HTMLMediaElement, or null if not assigned.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    |
| Controls                | ValueTask&lt;bool&gt;          | get     | A boolean that reflects the controls HTML attribute, indicating whether user interface items for controlling the resource should be displayed.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               |
| Autoplay                | ValueTask&lt;bool&gt;          | get     | A boolean value that reflects the autoplay HTML attribute, indicating whether playback should automatically begin as soon as enough media is available to do so without interruption. A media element whose source is a MediaStream and whose autoplay property is true will begin playback when it becomes active(that is, when MediaStream.active becomes true).                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           |
| Loop                    | ValueTask&lt;bool&gt;          | get     | A boolean that reflects the loop HTML attribute, which indicates whether the media element should start over when it reaches the end.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        |
| DefaultMuted            | ValueTask&lt;bool&gt;          | get     | A boolean that reflects the muted HTML attribute, which indicates whether the media element's audio output should be muted by default. This property has no dynamic effect. To mute and unmute the audio output, use the muted property.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     |
| Preload                 | ValueTask&lt;string&gt;        | get     | A string that reflects the preload HTML attribute, indicating what data should be preloaded, if any. Possible values are:<br></br>- "none": Indicates that the media should not be preloaded.<br></br>- "metadata": Indicates that only media metadata (e.g. length) is fetched.<br></br>- "auto": Indicates that the whole media file can be downloaded, even if the user is not expected to use it.<br></br>"": A synonym of the auto value.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               |
| CurrentSrc              | ValueTask&lt;string&gt;        | get     | Returns a string with the absolute URL of the chosen media resource. This could happen, for example, if the web server selects a media file based on the resolution of the user's display. The value is an empty string if the networkState property is EMPTY.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               |
| CurrentTime             | ValueTask&lt;double&gt;        | get     | A double-precision floating-point value indicating the current playback time in seconds. if the media has not started to play and has not been seeked, this value is the media's initial playback time. Setting this value seeks the media to the new time. The time is specified relative to the media's timeline.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          |
| Duration                | ValueTask&lt;double&gt;        | get     | A read-only double-precision floating-point value indicating the total duration of the media in seconds. If no media data is available, the returned value is NaN. If the media is of indefinite length (such as streamed live media, a WebRTC call's media, or similar), the value is +Infinity.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            |
| Seekable                | ValueTask&lt;TimeRange[]&gt;   | get     | Returns a TimeRanges object that contains the time ranges that the user is able to seek to.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  |
| Muted                   | ValueTask&lt;bool&gt;          | get     | A boolean that determines whether audio is muted. true if the audio is muted and false otherwise. true means muted and false means not muted.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                |
| Volume                  | ValueTask&lt;double&gt;        | get     | A double indicating the audio volume, from 0.0 (silent) to 1.0 (loudest).                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    |
| Paused                  | ValueTask&lt;bool&gt;          | get     | Returns a boolean that indicates whether the media element is paused. true is paused and false is not paused.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                |
| Ended                   | ValueTask&lt;bool&gt;          | get     | Returns a boolean that indicates whether the media element has finished playing. true if the media contained in the element has finished playing. If the source of the media is a MediaStream, this value is true if the value of the stream's active property is false.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     |
| Seeking                 | ValueTask&lt;bool&gt;          | get     | Returns a boolean that indicates whether the media is in the process of seeking to a new position.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           |
| ReadyState              | ValueTask&lt;int&gt;           | get     | Returns a unsigned short (enumeration) indicating the readiness state of the media. Possible values are:<br></br>0 = HAVE_NOTHING: No information is available about the media resource.<br></br>1 = HAVE_METADATA: Enough of the media resource has been retrieved that the metadata attributes are initialized. Seeking will no longer raise an exception.<br></br>2 = HAVE_CURRENT_DATA: Data is available for the current playback position, but not enough to actually play more than one frame.<br></br>3 = HAVE_FUTURE_DATA: Data for the current playback position as well as for at least a little bit of time into the future is available (in other words, at least two frames of video, for example).<br></br>4 = HAVE_ENOUGH_DATA: Enough data is available—and the download rate is high enough—that the media can be played through to the end without interruption.                                                                          |
| NetworkState            | ValueTask&lt;int&gt;           | get     | Returns a unsigned short (enumeration) indicating the current state of fetching the media over the network. Possible values are:<br></br>0 = NETWORK_EMPTY: There is no data yet. Also, readyState is HAVE_NOTHING.<br></br>1 = NETWORK_IDLE: HTMLMediaElement is active and has selected a resource, but is not using the network.<br></br>2 = NETWORK_LOADING: The browser is downloading HTMLMediaElement data.<br></br>3 = NETWORK_NO_SOURCE: No HTMLMediaElement src found.                                                                                                                                                                                                                                                                                                                                                                                                                                                                             |
| Buffered                | ValueTask&lt;TimeRange[]&gt;   | get     | Returns a TimeRanges object that indicates the ranges of the media source that the browser has buffered (if any) at the moment the buffered property is accessed.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            |
| Played                  | ValueTask&lt;TimeRange[]&gt;   | get     | Returns a TimeRanges object that contains the ranges of the media source that the browser has played, if any.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                |
| PlaybackRate            | ValueTask&lt;double&gt;        | get     | A double that indicates the rate at which the media is being played back. This is used to implement user controls for fast forward, slow motion, and so forth. The normal playback rate is multiplied by this value to obtain the current rate, so a value of 1.0 indicates normal speed. A negative playbackRate value indicates that the media should be played backwards, but support for this is not yet widespread. The audio is muted when the fast forward or slow motion is outside a useful range(for example, Gecko mutes the sound outside the range 0.25 to 4.0). The pitch of the audio is corrected by default. You can disable pitch correction using the HTMLMediaElement.preservesPitch property.                                                                                                                                                                                                                                           |
| DefaultPlaybackRate     | ValueTask&lt;double&gt;        | get     | A double indicating the default playback rate for the media. A double. 1.0 is "normal speed," values lower than 1.0 make the media play slower than normal, higher values make it play faster.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               |
| CrossOrigin             | ValueTask&lt;string&gt;        | get     | A string indicating the CORS setting for this media element. See [CORS settings attributes](https://developer.mozilla.org/en-US/docs/Web/HTML/Attributes/crossorigin) for details. Possible values are:<br></br>- "anonymous": Requests sent by the HTMLMediaElement will use the *cors* mode and the *same-origin* credentials mode. This means that CORS is enabled and credentials are sent if the resource is fetched from the same origin from which the document was loaded.<br></br>- "use-credentials": Requests sent by the HTMLMediaElement will use the *cors* mode and the *include* credentials mode. All resources requests by the element will use CORS, regardless of what domain the fetch is from.<br></br>- "" (or any other value): The same as specifing as "anonymous".<br></br>If the <i>crossOrigin</i> property is not specified, the resource is fetched without CORS (the *no-cors* mode and the *same-origin* credentials mode). |
| PreservesPitch          | ValueTask&lt;bool&gt;          | get     | A boolean value that determines if the pitch of the sound will be preserved. If set to false, the pitch will adjust to the speed of the audio. Default is true.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              |
| DisableRemotePlayback   | ValueTask&lt;bool&gt;          | get     | A boolean that sets or returns the remote playback state, indicating whether the media element is allowed to have a remote playback UI. false means "not disabled", which means "enabled"                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    |
| Width                   | ValueTask&lt;int&gt;           | get     | &lt;video&gt; elements only<br/>Reflects the width attribute of the &lt;video&gt; element, specifying the displayed width of the resource in CSS pixels.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     |
| Height                  | ValueTask&lt;int&gt;           | get     | &lt;video&gt; elements only<br/>Reflects the height attribute of the &lt;video&gt; element, specifying the displayed height of the resource in CSS pixels.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   |
| VideoWidth              | ValueTask&lt;int&gt;           | get     | &lt;video&gt; elements only<br/>Indicates the intrinsic width of the video, expressed in CSS pixels. In simple terms, this is the width of the media in its natural size.<br/>If the element's *ReadyState* is HTMLMediaElement.HAVE_NOTHING, then the value of this property is 0, because neither video nor poster frame size information is yet available.<br/>See [HTMLVideoElement.videoHeight > About intrinsic width and height](https://developer.mozilla.org/en-US/docs/Web/API/HTMLVideoElement/videoHeight#about_intrinsic_width_and_height) for more details.                                                                                                                                                                                                                                                                                                                                                                                    |
| VideoHeight             | ValueTask&lt;int&gt;           | get     | &lt;video&gt; elements only<br/>Indicates the intrinsic height of the video, expressed in CSS pixels. In simple terms, this is the height of the media in its natural size.<br/>If the element's *ReadyState* is HTMLMediaElement.HAVE_NOTHING, then the value of this property is 0, because neither video nor poster frame size information is yet available.<br/>See [HTMLVideoElement.videoHeight > About intrinsic width and height](https://developer.mozilla.org/en-US/docs/Web/API/HTMLVideoElement/videoHeight#about_intrinsic_width_and_height) for more details.                                                                                                                                                                                                                                                                                                                                                                                  |
| Poster                  | ValueTask&lt;string&gt;        | get     | &lt;video&gt; elements only<br/>Reflects the URL for an image to be shown while no video data is available. If the property does not represent a valid URL, no poster frame will be shown.<br/>It reflects the poster attribute of the &lt;video&gt; element.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                |
| DisablePictureInPicture | ValueTask&lt;bool&gt;          | get     | &lt;video&gt; elements only<br/>Reflects the HTML attribute indicating whether the picture-in-picture feature is disabled for the current element.<br/>This value only represents a request from the website to the user agent. User configuration may change the eventual behavior—for example, Firefox users can change the media.videocontrols.picture-in-picture.respect-disablePictureInPicture setting to ignore the request to disable PiP.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           |

#### Methods

| **Name**                   | **Parameters**                                                       | **ReturnType**                 | **Description**                                                                                                                                                                                                                                                                                                                                                                                       |
| -------------------------- | -------------------------------------------------------------------- | ------------------------------ | ----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- |
| ToHTMLElement              | [CancellationToken cancellationToken = default]                      | ValueTask&lt;IHTMLElement&gt;  | Creates a new JS object and a new C# object to represent the underlying html element as [HTMLElement](https://developer.mozilla.org/en-US/docs/Web/API/HTMLElement).<br></br>Note: The original object as well as the returned result must be disposed manually. Do not forget to Dispose each object when you are done with it.                                                                      |
| GetSrc                     | CancellationToken cancellationToken                                  | ValueTask&lt;string&gt;        | see Property *Src*                                                                                                                                                                                                                                                                                                                                                                                    |
| SetSrc                     | string value, [CancellationToken cancellationToken = default]        | ValueTask                      | see Property *Src*                                                                                                                                                                                                                                                                                                                                                                                    |
| GetSrcObject               | CancellationToken cancellationToken                                  | ValueTask&lt;IMediaStream?&gt; | see Property *SrcObject*                                                                                                                                                                                                                                                                                                                                                                              |
| SetSrcObject               | IMediaStream? value, [CancellationToken cancellationToken = default] | ValueTask                      | see Property *SrcObject*                                                                                                                                                                                                                                                                                                                                                                              |
| GetControls                | CancellationToken cancellationToken                                  | ValueTask&lt;bool&gt;          | see Property *Controls*                                                                                                                                                                                                                                                                                                                                                                               |
| SetControls                | bool value, [CancellationToken cancellationToken = default]          | ValueTask                      | see Property *Controls*                                                                                                                                                                                                                                                                                                                                                                               |
| GetAutoplay                | CancellationToken cancellationToken                                  | ValueTask&lt;bool&gt;          | see Property *Autoplay*                                                                                                                                                                                                                                                                                                                                                                               |
| SetAutoplay                | bool value, [CancellationToken cancellationToken = default]          | ValueTask                      | see Property *Autoplay*                                                                                                                                                                                                                                                                                                                                                                               |
| GetLoop                    | CancellationToken cancellationToken                                  | ValueTask&lt;bool&gt;          | see Property *Loop*                                                                                                                                                                                                                                                                                                                                                                                   |
| SetLoop                    | bool value, [CancellationToken cancellationToken = default]          | ValueTask                      | see Property *Loop*                                                                                                                                                                                                                                                                                                                                                                                   |
| GetDefaultMuted            | CancellationToken cancellationToken                                  | ValueTask&lt;bool&gt;          | see Property *DefaultMuted*                                                                                                                                                                                                                                                                                                                                                                           |
| SetDefaultMuted            | bool value, [CancellationToken cancellationToken = default]          | ValueTask                      | see Property *DefaultMuted*                                                                                                                                                                                                                                                                                                                                                                           |
| GetPreload                 | CancellationToken cancellationToken                                  | ValueTask&lt;string&gt;        | see Property *Preload*                                                                                                                                                                                                                                                                                                                                                                                |
| SetPreload                 | string value, [CancellationToken cancellationToken = default]        | ValueTask             ;        | see Property *Preload*                                                                                                                                                                                                                                                                                                                                                                                |
| GetCurrentSrc              | CancellationToken cancellationToken                                  | ValueTask&lt;string&gt;        | see Property *CurrentSrc*                                                                                                                                                                                                                                                                                                                                                                             |
| GetCurrentTime             | CancellationToken cancellationToken                                  | ValueTask&lt;double&gt;        | see Property *CurrentTime*                                                                                                                                                                                                                                                                                                                                                                            |
| SetCurrentTime             | double value, [CancellationToken cancellationToken = default]        | ValueTask                      | see Property *CurrentTime*                                                                                                                                                                                                                                                                                                                                                                            |
| GetDuration                | CancellationToken cancellationToken                                  | ValueTask&lt;double&gt;        | see Property *Duration*                                                                                                                                                                                                                                                                                                                                                                               |
| GetSeekable                | CancellationToken cancellationToken                                  | ValueTask&lt;TimeRange[]&gt;   | see Property *Seekable*                                                                                                                                                                                                                                                                                                                                                                               |
| GetMuted                   | CancellationToken cancellationToken                                  | ValueTask&lt;bool&gt;          | see Property *Muted*                                                                                                                                                                                                                                                                                                                                                                                  |
| SetMuted                   | bool value, [CancellationToken cancellationToken = default]          | ValueTask                      | see Property *Muted*                                                                                                                                                                                                                                                                                                                                                                                  |
| GetVolume                  | CancellationToken cancellationToken                                  | ValueTask&lt;double&gt;        | see Property *Volume*                                                                                                                                                                                                                                                                                                                                                                                 |
| SetVolume                  | double value, [CancellationToken cancellationToken = default]        | ValueTask                      | see Property *Volume*                                                                                                                                                                                                                                                                                                                                                                                 |
| GetPaused                  | CancellationToken cancellationToken                                  | ValueTask&lt;bool&gt;          | see Property *Paused*                                                                                                                                                                                                                                                                                                                                                                                 |
| GetEnded                   | CancellationToken cancellationToken                                  | ValueTask&lt;bool&gt;          | see Property *Ended*                                                                                                                                                                                                                                                                                                                                                                                  |
| GetSeeking                 | CancellationToken cancellationToken                                  | ValueTask&lt;bool&gt;          | see Property *Seeking*                                                                                                                                                                                                                                                                                                                                                                                |
| GetReadyState              | CancellationToken cancellationToken                                  | ValueTask&lt;int&gt;           | see Property *ReadyState*                                                                                                                                                                                                                                                                                                                                                                             |
| GetNetworkState            | CancellationToken cancellationToken                                  | ValueTask&lt;int&gt;           | see Property *NetworkState*                                                                                                                                                                                                                                                                                                                                                                           |
| GetBuffered                | CancellationToken cancellationToken                                  | ValueTask&lt;TimeRange[]&gt;   | see Property *Buffered*                                                                                                                                                                                                                                                                                                                                                                               |
| GetPlayed                  | CancellationToken cancellationToken                                  | ValueTask&lt;TimeRange[]&gt;   | see Property *Played*                                                                                                                                                                                                                                                                                                                                                                                 |
| GetPlaybackRate            | CancellationToken cancellationToken                                  | ValueTask&lt;double&gt;        | see Property *PlaybackRate*                                                                                                                                                                                                                                                                                                                                                                           |
| SetPlaybackRate            | double value, [CancellationToken cancellationToken = default]        | ValueTask                      | see Property *PlaybackRate*                                                                                                                                                                                                                                                                                                                                                                           |
| GetDefaultPlaybackRate     | CancellationToken cancellationToken                                  | ValueTask&lt;double&gt;        | see Property *DefaultPlaybackRate*                                                                                                                                                                                                                                                                                                                                                                    |
| SetDefaultPlaybackRate     | double value, [CancellationToken cancellationToken = default]        | ValueTask                      | see Property *DefaultPlaybackRate*                                                                                                                                                                                                                                                                                                                                                                    |
| GetCrossOrigin             | CancellationToken cancellationToken                                  | ValueTask&lt;string&gt;        | see Property *CrossOrigin*                                                                                                                                                                                                                                                                                                                                                                            |
| SetCrossOrigin             | string value, [CancellationToken cancellationToken = default]        | ValueTask                      | see Property *CrossOrigin*                                                                                                                                                                                                                                                                                                                                                                            |
| GetPreservesPitch          | CancellationToken cancellationToken                                  | ValueTask&lt;bool&gt;          | see Property *PreservesPitch*                                                                                                                                                                                                                                                                                                                                                                         |
| SetPreservesPitch          | bool value, [CancellationToken cancellationToken = default]          | ValueTask                      | see Property *PreservesPitch*                                                                                                                                                                                                                                                                                                                                                                         |
| GetDisableRemotePlayback   | CancellationToken cancellationToken                                  | ValueTask&lt;bool&gt;          | see Property *DisableRemotePlayback*                                                                                                                                                                                                                                                                                                                                                                  |
| SetDisableRemotePlayback   | bool value, [CancellationToken cancellationToken = default]          | ValueTask                      | see Property *DisableRemotePlayback*                                                                                                                                                                                                                                                                                                                                                                  |
| GetWidth                   | CancellationToken cancellationToken                                  | ValueTask&lt;int&gt;           | see Property *Width*                                                                                                                                                                                                                                                                                                                                                                                  |
| SetWidth                   | int value, [CancellationToken cancellationToken = default]           | ValueTask                      | see Property *Width*                                                                                                                                                                                                                                                                                                                                                                                  |
| GetHeight                  | CancellationToken cancellationToken                                  | ValueTask&lt;int&gt;           | see Property *Height*                                                                                                                                                                                                                                                                                                                                                                                 |
| SetHeight                  | int value, [CancellationToken cancellationToken = default]           | ValueTask                      | see Property *Height*                                                                                                                                                                                                                                                                                                                                                                                 |
| GetVideoWidth              | CancellationToken cancellationToken                                  | ValueTask&lt;int&gt;           | see Property *VideoWidth*                                                                                                                                                                                                                                                                                                                                                                             |
| GetVideoHeight             | CancellationToken cancellationToken                                  | ValueTask&lt;int&gt;           | see Property *VideoHeight*                                                                                                                                                                                                                                                                                                                                                                            |
| GetPoster                  | CancellationToken cancellationToken                                  | ValueTask&lt;string&gt;        | see Property *Poster*                                                                                                                                                                                                                                                                                                                                                                                 |
| SetPoster                  | string value, [CancellationToken cancellationToken = default]        | ValueTask                      | see Property *Poster*                                                                                                                                                                                                                                                                                                                                                                                 |
| GetDisablePictureInPicture | CancellationToken cancellationToken                                  | ValueTask&lt;bool&gt;          | see Property *DisablePictureInPicture*                                                                                                                                                                                                                                                                                                                                                                |
| SetDisablePictureInPicture | bool value, [CancellationToken cancellationToken = default]          | ValueTask                      | see Property *DisablePictureInPicture*                                                                                                                                                                                                                                                                                                                                                                |
| Play                       | [CancellationToken cancellationToken = default]                      | ValueTask                      | Attempts to begin playback of the media. It returns a Promise which is resolved when playback has been successfully started. Failure to begin playback for any reason, such as permission issues, result in the promise being rejected.                                                                                                                                                               |
| Pause                      | *empty*                                                              | void                           | Pauses the media playback. If the media is already in a paused state this method will have no effect.                                                                                                                                                                                                                                                                                                 |
| Load                       | *empty*                                                              | void                           | Resets the media to the beginning and selects the best available source from the sources provided using the *src* attribute or the *&lt;source&gt;* element.                                                                                                                                                                                                                                          |
| FastSeek                   | double time                                                          | void                           | Quickly seeks to the given time with low precision. Note: If you need to seek with precision, you should set HTMLMediaElement.currentTime instead.                                                                                                                                                                                                                                                    |
| CanPlayType                | string type                                                          | string                         | Given a string specifying a MIME media type (potentially with the codecs parameter included), canPlayType() returns the string<br></br>- "probably", if the media should be playable<br></br>- "maybe", if there's not enough information to determine whether the media will play or not<br></br>- "", if the media cannot be played.                                                                |
| RequestPictureInPicture    | [CancellationToken cancellationToken = default]                      | ValueTask&lt;IPictureInPictureWindow&gt; | &lt;video&gt; elements only<br/>Issues an asynchronous request to display the video in picture-in-picture mode.<br/>It's not guaranteed that the video will be put into picture-in-picture. If permission to enter that mode is granted, the returned Promise will resolve and the video will receive a enterpictureinpicture event to let it know that it's now in picture-in-picture. |

#### Events

| **Name**                | **Type**                              | **Description**                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       |
| ----------------------- | ------------------------------------- | --------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- |
| OnError                 | Action&lt;int, string&gt;             | Fired when the resource could not be loaded due to an error (for example, a network connectivity problem). This event is not cancelable and does not bubble. If an error already occurred when subscribing ([error](https://developer.mozilla.org/en-US/docs/Web/API/HTMLMediaElement/error) property is not empty), this event is fired immediately. Note: When [error](https://developer.mozilla.org/en-US/docs/Web/API/HTMLMediaElement/error) is not empty, this event is fired with every subscription.<br></br>**Parameters**<br/>- int *code*: A number which represents the general type of error that occurred. Possible values are: 1 = MEDIA_ERR_ABORTED, 2 = MEDIA_ERR_NETWORK, 3 = MEDIA_ERR_DECODE, 4 = MEDIA_ERR_SRC_NOT_SUPPORTED<br/>- string *message*: A human-readable string which provides specific diagnostic information to help the reader understand the error condition which occurred; specifically, it isn't a summary of what the error code means, but actual diagnostic information to help in understanding what exactly went wrong. |
| OnCanPlay               | Action                                | Fired when the user agent can play the media, but estimates that not enough data has been loaded to play the media up to its end without having to stop for further buffering of content. This event is not cancelable and does not bubble.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           |
| OnCanPlayThrough        | Action                                | Fired when the user agent can play the media, and estimates that enough data has been loaded to play the media up to its end without having to stop for further buffering of content. This event is not cancelable and does not bubble.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               |
| OnPlaying               | Action                                | Fired after playback is first started, and whenever it is restarted. For example it is fired when playback resumes after having been paused or delayed due to lack of data. This event is not cancelable and does not bubble.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         |
| OnLoadStart             | Action                                | Fired when the browser has started to load a resource.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                |
| OnProgress              | Action                                | Fired periodically as the browser loads a resource. This event is not cancelable and does not bubble.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 |
| OnLoadedData            | Action                                | Fired when the first frame of the media has finished loading; often the first frame.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  |
| OnLoadedMetadata        | Action                                | Fired when the metadata has been loaded.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              |
| OnStalled               | Action                                | Fired when the user agent is trying to fetch media data, but data is unexpectedly not forthcoming. This event is not cancelable and does not bubble.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  |
| OnSuspend               | Action                                | Fired when the media data loading has been suspended. This event is not cancelable and does not bubble.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               |
| OnWaiting               | Action                                | Fired when playback has stopped because of a temporary lack of data. This event is not cancelable and does not bubble.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                |
| OnAbort                 | Action                                | Fired when the resource was not fully loaded, but not as the result of an error. This event is not cancelable and does not bubble.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    |
| OnEmptied               | Action                                | Fired when the media has become empty; for example, when the media has already been loaded (or partially loaded), and the *Load()* method is called to reload it. This event is not cancelable and does not bubble.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   |
| OnPlay                  | Action                                | Fired when the paused property is changed from true to false, as a result of the *Play()* method, or the autoplay attribute. This event is not cancelable and does not bubble.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        |
| OnPause                 | Action                                | Fired when a request to pause play is handled and the activity has entered its paused state, most commonly occurring when the media's *Pause()* method is called. The event is sent once the *Pause()* method returns and after the media element's paused property has been changed to true. This event is not cancelable and does not bubble.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       |
| OnEnded                 | Action                                | Fired when playback stops when end of the media (&lt;audio&gt; and &lt;video&gt;) is reached or because no further data is available. This event occurs based upon HTMLMediaElement (&lt;audio&gt; and &lt;video&gt;) fire ended when playback reaches the end of the media. This event is not cancelable and does not bubble.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        |
| OnSeeking               | Action                                | Fired when a seek operation starts, meaning the Boolean seeking attribute has changed to true and the media is seeking a new position. This event is not cancelable and does not bubble.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              |
| OnSeeked                | Action                                | Fired when a seek operation completed, the current playback position has changed, and the Boolean seeking attribute is changed to false. This event is not cancelable and does not bubble.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            |
| OnTimeUpdate            | Action                                | Fired when the time indicated by the currentTime attribute has been updated. The event frequency is dependent on the system load, but will be thrown between about 4Hz and 66Hz (assuming the event handlers don't take longer than 250ms to run). User agents are encouraged to vary the frequency of the event based on the system load and the average cost of processing the event each time, so that the UI updates are not any more frequent than the user agent can comfortably handle while decoding the video. This event is not cancelable and does not bubble.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             |
| OnVolumeChange          | Action                                | Fired when either the volume attribute or the muted attribute has changed. This event is not cancelable and does not bubble.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          |
| OnRateChange            | Action                                | Fired when the playback rate has changed. This event is not cancelable and does not bubble.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           |
| OnDurationChange        | Action                                | Fired when the duration attribute has been updated.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   |
| OnResize                | Action                                | Fires when one or both of the videoWidth and videoHeight properties have just been updated.<br/>This event is not cancelable but may bubble.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          |
| OnEnterPictureInPicture | Action&lt;IPictureInPictureWindow&gt; | Is fired when the HTMLVideoElement enters picture-in-picture mode successfully.<br/>This event is not cancelable and does not bubble.<br></br>Parameter returns the PictureInPictureWindow the event relates to.<br/>Note: Dispose the given PictureInPictureWindow object when you are done with it.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 |
| OnLeavePictureInPicture | Action&lt;IPictureInPictureWindow&gt; | Is fired when the HTMLVideoElement leaves picture-in-picture mode successfully.<br/>This event is not cancelable and does not bubble.<br></br>Parameter returns the PictureInPictureWindow the event relates to.<br/>Note: Dispose the given PictureInPictureWindow object when you are done with it.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 |


<br></br>
### IPictureInPictureWindow

Represents an object able to programmatically obtain the width and height and resize event of the floating video window.  
An object with this interface is obtained using the *RequestPictureInPicture()* return value.

Objects of this class must disposed manually, so do not forget to call *DisposeAsync* when you are done with it.

#### Properties

| **Name** | **Type**             | get/set | **Description**                                                                                   |
| -------- | -------------------- | ------- | ------------------------------------------------------------------------------------------------- |
| Width    | ValueTask&lt;int&gt; | get     | Returns the width of the floating video window in pixels if it is open. Otherwise, it returns 0.  |
| Height   | ValueTask&lt;int&gt; | get     | Returns the height of the floating video window in pixels if it is open. Otherwise, it returns 0. |

#### Methods

| **Name**  | **Parameters**                      | **ReturnType**       | **Description**       |
| --------- | ----------------------------------- | -------------------- | --------------------- |
| GetWidth  | CancellationToken cancellationToken | ValueTask&lt;int&gt; | see Property *Width*  |
| GetHeight | CancellationToken cancellationToken | ValueTask&lt;int&gt; | see Property *Height* |

#### Events

| **Name** | **Type** | **Description**                                                                                              |
| -------- | -------- | ------------------------------------------------------------------------------------------------------------ |
| OnResize | Action   | Fires when the floating video window has been resized.<br/>This event is not cancelable and does not bubble. |



<br></br>
### IElementFactoryInProcess

An instance of this class takes a *ElementReference* and exposes an interface to interact with it.

This factory **does not dispose** the created onjects, they must disposed manually.
So do not forget to call Dispose() on a dialog-object when you are done with it.

#### Methods

| **Name**               | **Parameters**                    | **ReturnType**             | **Description**                                                                                                                                                                                                                                                                              |
| ---------------------- | --------------------------------- | -------------------------- | -------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- |
| CreateHTMLMediaElement | ElementReference htmlMediaElement | IHTMLMediaElementInProcess | Takes a *ElementReference* of [HTMLVideoElement](https://developer.mozilla.org/en-US/docs/Web/API/HTMLVideoElement) or [HTMLAudioElement](https://developer.mozilla.org/en-US/docs/Web/API/HTMLAudioElement) and returns a *IHTMLMediaElement* interface to interact with the given element. |


<br></br>
### IHTMLMediaElementInProcess

The *HTMLMediaElement* interface adds to HTMLElement the properties and methods needed to support basic media-related capabilities that are common to audio and video.

The [HTMLVideoElement](https://developer.mozilla.org/en-US/docs/Web/API/HTMLVideoElement) and [HTMLAudioElement](https://developer.mozilla.org/en-US/docs/Web/API/HTMLAudioElement) elements both inherit this interface.

Objects of this class must disposed manually, so do not forget to call Dispose() when you are done with it.

#### Properties

| **Name**                | **Type**               | get/set | **Description**                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              |
| ----------------------- | ---------------------- | ------- | ------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------ |
| Src                     | string                 | get/set | A string that reflects the src HTML attribute, which contains the URL of a media resource to use. Note: The best way to know the URL of the media resource currently in active use in this element is to look at the value of the currentSrc attribute, which also takes into account selection of a best or preferred media resource from a list provided in an HTMLSourceElement (which represents a &lt;source&gt; element).                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              |
| SrcObject               | IMediaStreamInProcess? | get/set | A MediaStream representing the media to play or that has played in the current HTMLMediaElement, or null if not assigned.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    |
| Controls                | bool                   | get/set | A boolean that reflects the controls HTML attribute, indicating whether user interface items for controlling the resource should be displayed.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               |
| Autoplay                | bool                   | get/set | A boolean value that reflects the autoplay HTML attribute, indicating whether playback should automatically begin as soon as enough media is available to do so without interruption. A media element whose source is a MediaStream and whose autoplay property is true will begin playback when it becomes active(that is, when MediaStream.active becomes true).                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           |
| Loop                    | bool                   | get/set | A boolean that reflects the loop HTML attribute, which indicates whether the media element should start over when it reaches the end.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        |
| DefaultMuted            | bool                   | get/set | A boolean that reflects the muted HTML attribute, which indicates whether the media element's audio output should be muted by default. This property has no dynamic effect. To mute and unmute the audio output, use the muted property.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     |
| Preload                 | string                 | get/set | A string that reflects the preload HTML attribute, indicating what data should be preloaded, if any. Possible values are:<br></br>- "none": Indicates that the media should not be preloaded.<br></br>- "metadata": Indicates that only media metadata (e.g. length) is fetched.<br></br>- "auto": Indicates that the whole media file can be downloaded, even if the user is not expected to use it.<br></br>"": A synonym of the auto value.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               |
| CurrentSrc              | string                 | get     | Returns a string with the absolute URL of the chosen media resource. This could happen, for example, if the web server selects a media file based on the resolution of the user's display. The value is an empty string if the networkState property is EMPTY.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               |
| CurrentTime             | double                 | get/set | A double-precision floating-point value indicating the current playback time in seconds. if the media has not started to play and has not been seeked, this value is the media's initial playback time. Setting this value seeks the media to the new time. The time is specified relative to the media's timeline.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          |
| Duration                | double                 | get     | A read-only double-precision floating-point value indicating the total duration of the media in seconds. If no media data is available, the returned value is NaN. If the media is of indefinite length (such as streamed live media, a WebRTC call's media, or similar), the value is +Infinity.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            |
| Seekable                | TimeRange[]            | get     | Returns a TimeRanges object that contains the time ranges that the user is able to seek to.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  |
| Muted                   | bool                   | get/set | A boolean that determines whether audio is muted. true if the audio is muted and false otherwise. true means muted and false means not muted.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                |
| Volume                  | double                 | get/set | A double indicating the audio volume, from 0.0 (silent) to 1.0 (loudest).                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    |
| Paused                  | bool                   | get     | Returns a boolean that indicates whether the media element is paused. true is paused and false is not paused.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                |
| Ended                   | bool                   | get     | Returns a boolean that indicates whether the media element has finished playing. true if the media contained in the element has finished playing. If the source of the media is a MediaStream, this value is true if the value of the stream's active property is false.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     |
| Seeking                 | bool                   | get     | Returns a boolean that indicates whether the media is in the process of seeking to a new position.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           |
| ReadyState              | int                    | get     | Returns a unsigned short (enumeration) indicating the readiness state of the media. Possible values are:<br></br>0 = HAVE_NOTHING: No information is available about the media resource.<br></br>1 = HAVE_METADATA: Enough of the media resource has been retrieved that the metadata attributes are initialized. Seeking will no longer raise an exception.<br></br>2 = HAVE_CURRENT_DATA: Data is available for the current playback position, but not enough to actually play more than one frame.<br></br>3 = HAVE_FUTURE_DATA: Data for the current playback position as well as for at least a little bit of time into the future is available (in other words, at least two frames of video, for example).<br></br>4 = HAVE_ENOUGH_DATA: Enough data is available—and the download rate is high enough—that the media can be played through to the end without interruption.                                                                          |
| NetworkState            | int                    | get     | Returns a unsigned short (enumeration) indicating the current state of fetching the media over the network. Possible values are:<br></br>0 = NETWORK_EMPTY: There is no data yet. Also, readyState is HAVE_NOTHING.<br></br>1 = NETWORK_IDLE: HTMLMediaElement is active and has selected a resource, but is not using the network.<br></br>2 = NETWORK_LOADING: The browser is downloading HTMLMediaElement data.<br></br>3 = NETWORK_NO_SOURCE: No HTMLMediaElement src found.                                                                                                                                                                                                                                                                                                                                                                                                                                                                             |
| Buffered                | TimeRange[]            | get     | Returns a TimeRanges object that indicates the ranges of the media source that the browser has buffered (if any) at the moment the buffered property is accessed.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            |
| Played                  | TimeRange[]            | get     | Returns a TimeRanges object that contains the ranges of the media source that the browser has played, if any.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                |
| PlaybackRate            | double                 | get/set | A double that indicates the rate at which the media is being played back. This is used to implement user controls for fast forward, slow motion, and so forth. The normal playback rate is multiplied by this value to obtain the current rate, so a value of 1.0 indicates normal speed. A negative playbackRate value indicates that the media should be played backwards, but support for this is not yet widespread. The audio is muted when the fast forward or slow motion is outside a useful range(for example, Gecko mutes the sound outside the range 0.25 to 4.0). The pitch of the audio is corrected by default. You can disable pitch correction using the HTMLMediaElement.preservesPitch property.                                                                                                                                                                                                                                           |
| DefaultPlaybackRate     | double                 | get/set | A double indicating the default playback rate for the media. A double. 1.0 is "normal speed," values lower than 1.0 make the media play slower than normal, higher values make it play faster.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               |
| CrossOrigin             | string                 | get/set | A string indicating the CORS setting for this media element. See [CORS settings attributes](https://developer.mozilla.org/en-US/docs/Web/HTML/Attributes/crossorigin) for details. Possible values are:<br></br>- "anonymous": Requests sent by the HTMLMediaElement will use the *cors* mode and the *same-origin* credentials mode. This means that CORS is enabled and credentials are sent if the resource is fetched from the same origin from which the document was loaded.<br></br>- "use-credentials": Requests sent by the HTMLMediaElement will use the *cors* mode and the *include* credentials mode. All resources requests by the element will use CORS, regardless of what domain the fetch is from.<br></br>- "" (or any other value): The same as specifing as "anonymous".<br></br>If the <i>crossOrigin</i> property is not specified, the resource is fetched without CORS (the *no-cors* mode and the *same-origin* credentials mode). |
| PreservesPitch          | bool                   | get/set | A boolean value that determines if the pitch of the sound will be preserved. If set to false, the pitch will adjust to the speed of the audio. Default is true.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              |
| DisableRemotePlayback   | bool                   | get/set | A boolean that sets or returns the remote playback state, indicating whether the media element is allowed to have a remote playback UI. false means "not disabled", which means "enabled"                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    |
| Width                   | int                    | get/set | &lt;video&gt; elements only<br/>Reflects the width attribute of the &lt;video&gt; element, specifying the displayed width of the resource in CSS pixels.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     |
| Height                  | int                    | get/set | &lt;video&gt; elements only<br/>Reflects the height attribute of the &lt;video&gt; element, specifying the displayed height of the resource in CSS pixels.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   |
| VideoWidth              | int                    | get     | &lt;video&gt; elements only<br/>Indicates the intrinsic width of the video, expressed in CSS pixels. In simple terms, this is the width of the media in its natural size.<br/>If the element's *ReadyState* is HTMLMediaElement.HAVE_NOTHING, then the value of this property is 0, because neither video nor poster frame size information is yet available.<br/>See [HTMLVideoElement.videoHeight > About intrinsic width and height](https://developer.mozilla.org/en-US/docs/Web/API/HTMLVideoElement/videoHeight#about_intrinsic_width_and_height) for more details.                                                                                                                                                                                                                                                                                                                                                                                    |
| VideoHeight             | int                    | get     | &lt;video&gt; elements only<br/>Indicates the intrinsic height of the video, expressed in CSS pixels. In simple terms, this is the height of the media in its natural size.<br/>If the element's *ReadyState* is HTMLMediaElement.HAVE_NOTHING, then the value of this property is 0, because neither video nor poster frame size information is yet available.<br/>See [HTMLVideoElement.videoHeight > About intrinsic width and height](https://developer.mozilla.org/en-US/docs/Web/API/HTMLVideoElement/videoHeight#about_intrinsic_width_and_height) for more details.                                                                                                                                                                                                                                                                                                                                                                                  |
| Poster                  | string                 | get/set | &lt;video&gt; elements only<br/>Reflects the URL for an image to be shown while no video data is available. If the property does not represent a valid URL, no poster frame will be shown.<br/>It reflects the poster attribute of the &lt;video&gt; element.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                |
| DisablePictureInPicture | bool                   | get/set | &lt;video&gt; elements only<br/>Reflects the HTML attribute indicating whether the picture-in-picture feature is disabled for the current element.<br/>This value only represents a request from the website to the user agent. User configuration may change the eventual behavior—for example, Firefox users can change the media.videocontrols.picture-in-picture.respect-disablePictureInPicture setting to ignore the request to disable PiP.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           |

#### Methods

| **Name**                   | **Parameters**                                  | **ReturnType**                                    | **Description**                                                                                                                                                                                                                                                                                                                                                                         |
| -------------------------- | ----------------------------------------------- | ------------------------------------------------- | --------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- |
| ToHTMLElement              | *empty*                                         | IHTMLElementInProcess                             | Creates a new JS object and a new C# object to represent the underlying html element as [HTMLElement](https://developer.mozilla.org/en-US/docs/Web/API/HTMLElement).<br></br>Note: The original object as well as the returned result must be disposed manually. Do not forget to Dispose each object when you are done with it.                                                        |
| Play                       | [CancellationToken cancellationToken = default] | ValueTask                                         | Attempts to begin playback of the media. It returns a Promise which is resolved when playback has been successfully started. Failure to begin playback for any reason, such as permission issues, result in the promise being rejected.                                                                                                                                                 |
| Pause                      | *empty*                                         | void                                              | Pauses the media playback. If the media is already in a paused state this method will have no effect.                                                                                                                                                                                                                                                                                   |
| Load                       | *empty*                                         | void                                              | Resets the media to the beginning and selects the best available source from the sources provided using the *src* attribute or the *&lt;source&gt;* element.                                                                                                                                                                                                                            |
| FastSeek                   | double time                                     | void                                              | Quickly seeks to the given time with low precision. Note: If you need to seek with precision, you should set HTMLMediaElement.currentTime instead.                                                                                                                                                                                                                                      |
| CanPlayType                | string type                                     | string                                            | Given a string specifying a MIME media type (potentially with the codecs parameter included), canPlayType() returns the string<br></br>- "probably", if the media should be playable<br></br>- "maybe", if there's not enough information to determine whether the media will play or not<br></br>- "", if the media cannot be played.                                                  |
| RequestPictureInPicture    | [CancellationToken cancellationToken = default] | ValueTask&lt;IPictureInPictureWindowInProcess&gt; | &lt;video&gt; elements only<br/>Issues an asynchronous request to display the video in picture-in-picture mode.<br/>It's not guaranteed that the video will be put into picture-in-picture. If permission to enter that mode is granted, the returned Promise will resolve and the video will receive a enterpictureinpicture event to let it know that it's now in picture-in-picture. |

#### Events

| **Name**                | **Type**                                       | **Description**                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       |
| ----------------------- | ---------------------------------------------- | --------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- |
| OnError                 | Action&lt;int, string&gt;                      | Fired when the resource could not be loaded due to an error (for example, a network connectivity problem). This event is not cancelable and does not bubble. If an error already occurred when subscribing ([error](https://developer.mozilla.org/en-US/docs/Web/API/HTMLMediaElement/error) property is not empty), this event is fired immediately. Note: When [error](https://developer.mozilla.org/en-US/docs/Web/API/HTMLMediaElement/error) is not empty, this event is fired with every subscription.<br></br>**Parameters**<br/>- int *code*: A number which represents the general type of error that occurred. Possible values are: 1 = MEDIA_ERR_ABORTED, 2 = MEDIA_ERR_NETWORK, 3 = MEDIA_ERR_DECODE, 4 = MEDIA_ERR_SRC_NOT_SUPPORTED<br/>- string *message*: A human-readable string which provides specific diagnostic information to help the reader understand the error condition which occurred; specifically, it isn't a summary of what the error code means, but actual diagnostic information to help in understanding what exactly went wrong. |
| OnCanPlay               | Action                                         | Fired when the user agent can play the media, but estimates that not enough data has been loaded to play the media up to its end without having to stop for further buffering of content. This event is not cancelable and does not bubble.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           |
| OnCanPlayThrough        | Action                                         | Fired when the user agent can play the media, and estimates that enough data has been loaded to play the media up to its end without having to stop for further buffering of content. This event is not cancelable and does not bubble.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               |
| OnPlaying               | Action                                         | Fired after playback is first started, and whenever it is restarted. For example it is fired when playback resumes after having been paused or delayed due to lack of data. This event is not cancelable and does not bubble.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         |
| OnLoadStart             | Action                                         | Fired when the browser has started to load a resource.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                |
| OnProgress              | Action                                         | Fired periodically as the browser loads a resource. This event is not cancelable and does not bubble.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 |
| OnLoadedData            | Action                                         | Fired when the first frame of the media has finished loading; often the first frame.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  |
| OnLoadedMetadata        | Action                                         | Fired when the metadata has been loaded.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              |
| OnStalled               | Action                                         | Fired when the user agent is trying to fetch media data, but data is unexpectedly not forthcoming. This event is not cancelable and does not bubble.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  |
| OnSuspend               | Action                                         | Fired when the media data loading has been suspended. This event is not cancelable and does not bubble.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               |
| OnWaiting               | Action                                         | Fired when playback has stopped because of a temporary lack of data. This event is not cancelable and does not bubble.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                |
| OnAbort                 | Action                                         | Fired when the resource was not fully loaded, but not as the result of an error. This event is not cancelable and does not bubble.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    |
| OnEmptied               | Action                                         | Fired when the media has become empty; for example, when the media has already been loaded (or partially loaded), and the *Load()* method is called to reload it. This event is not cancelable and does not bubble.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   |
| OnPlay                  | Action                                         | Fired when the paused property is changed from true to false, as a result of the *Play()* method, or the autoplay attribute. This event is not cancelable and does not bubble.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        |
| OnPause                 | Action                                         | Fired when a request to pause play is handled and the activity has entered its paused state, most commonly occurring when the media's *Pause()* method is called. The event is sent once the *Pause()* method returns and after the media element's paused property has been changed to true. This event is not cancelable and does not bubble.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       |
| OnEnded                 | Action                                         | Fired when playback stops when end of the media (&lt;audio&gt; and &lt;video&gt;) is reached or because no further data is available. This event occurs based upon HTMLMediaElement (&lt;audio&gt; and &lt;video&gt;) fire ended when playback reaches the end of the media. This event is not cancelable and does not bubble.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        |
| OnSeeking               | Action                                         | Fired when a seek operation starts, meaning the Boolean seeking attribute has changed to true and the media is seeking a new position. This event is not cancelable and does not bubble.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              |
| OnSeeked                | Action                                         | Fired when a seek operation completed, the current playback position has changed, and the Boolean seeking attribute is changed to false. This event is not cancelable and does not bubble.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            |
| OnTimeUpdate            | Action                                         | Fired when the time indicated by the currentTime attribute has been updated. The event frequency is dependent on the system load, but will be thrown between about 4Hz and 66Hz (assuming the event handlers don't take longer than 250ms to run). User agents are encouraged to vary the frequency of the event based on the system load and the average cost of processing the event each time, so that the UI updates are not any more frequent than the user agent can comfortably handle while decoding the video. This event is not cancelable and does not bubble.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             |
| OnVolumeChange          | Action                                         | Fired when either the volume attribute or the muted attribute has changed. This event is not cancelable and does not bubble.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          |
| OnRateChange            | Action                                         | Fired when the playback rate has changed. This event is not cancelable and does not bubble.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           |
| OnDurationChange        | Action                                         | Fired when the duration attribute has been updated.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   |
| OnResize                | Action                                         | Fires when one or both of the videoWidth and videoHeight properties have just been updated.<br/>This event is not cancelable but may bubble.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          |
| OnEnterPictureInPicture | Action&lt;IPictureInPictureWindowInProcess&gt; | Is fired when the HTMLVideoElement enters picture-in-picture mode successfully.<br/>This event is not cancelable and does not bubble.<br></br>Parameter returns the PictureInPictureWindow the event relates to.<br/>Note: Dispose the given PictureInPictureWindow object when you are done with it.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 |
| OnLeavePictureInPicture | Action&lt;IPictureInPictureWindowInProcess&gt; | Is fired when the HTMLVideoElement leaves picture-in-picture mode successfully.<br/>This event is not cancelable and does not bubble.<br></br>Parameter returns the PictureInPictureWindow the event relates to.<br/>Note: Dispose the given PictureInPictureWindow object when you are done with it.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 |


<br></br>
### IPictureInPictureWindowInProcess

Represents an object able to programmatically obtain the width and height and resize event of the floating video window.  
An object with this interface is obtained using the *RequestPictureInPicture()* return value.

Objects of this class must disposed manually, so do not forget to call *Dispose* when you are done with it.

#### Properties

| **Name** | **Type** | get/set | **Description**                                                                                   |
| -------- | -------- | ------- | ------------------------------------------------------------------------------------------------- |
| Width    | int      | get     | Returns the width of the floating video window in pixels if it is open. Otherwise, it returns 0.  |
| Height   | int      | get     | Returns the height of the floating video window in pixels if it is open. Otherwise, it returns 0. |

#### Events

| **Name** | **Type** | **Description**                                                                                              |
| -------- | -------- | ------------------------------------------------------------------------------------------------------------ |
| OnResize | Action   | Fires when the floating video window has been resized.<br/>This event is not cancelable and does not bubble. |
