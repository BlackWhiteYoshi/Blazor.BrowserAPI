# Window

The Window interface represents a window containing a DOM document; the document property points to the DOM document loaded in that window.

A window for a given document can be obtained using the document.defaultView property.

A global variable, window, representing the window in which the script is running, is exposed to JavaScript code.

The Window interface is home to a variety of functions, namespaces, objects, and constructors which are not necessarily directly associated with the concept of a user interface window.
However, the Window interface is a suitable place to include these items that need to be globally available.
Many of these are documented in the [JavaScript Reference](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference)
and the [DOM Reference](https://developer.mozilla.org/en-US/docs/Web/API/Document_Object_Model).

In a tabbed browser, each tab is represented by its own Window object; the global window seen by JavaScript code running within a given tab always represents the tab in which the code is running.
That said, even in a tabbed browser, some properties and methods still apply to the overall window that contains the tab, such as *ResizeTo* and *InnerHeight*.
Generally, anything that can't reasonably pertain to a tab pertains to the window instead.


<br><br />
## Example

```csharp
public sealed class ExampleComponent : ComponentBase {
    [Inject]
    public required IWindow Window { private get; init; }

    private async Task Example() {
        // TODO
    }
}
```


<br><br />
## Members

### IWindow

#### Properties

| **Name**            | **Type**                       | get/set | **Description**                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     |
| ------------------- | ------------------------------ | ------- | ------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- |
| InnerWidth          | ValueTask&lt;int&gt;           | get     | Returns the interior width of the window in pixels (that is, the width of the window's layout viewport). That includes the width of the vertical scroll bar, if one is present.<br/>Similarly, the interior height of the window (that is, the height of the layout viewport) can be obtained using the innerHeight property. That measurement also accounts for the height of the horizontal scroll bar, if it is visible.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         |
| InnerHeight         | ValueTask&lt;int&gt;           | get     | Returns the interior height of the window in pixels, including the height of the horizontal scroll bar, if present.<br/>The value of innerHeight is taken from the height of the window's layout viewport. The width can be obtained using the *InnerWidth* property.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               |
| OuterWidth          | ValueTask&lt;int&gt;           | get     | Returns the width of the outside of the browser window. It represents the width of the whole browser window including sidebar (if expanded), window chrome and window resizing borders/handles.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     |
| OuterHeight         | ValueTask&lt;int&gt;           | get     | Returns the height in pixels of the whole browser window, including any sidebar, window chrome, and window-resizing borders/handles.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                |
| DevicePixelRatio    | ValueTask&lt;double&gt;        | get     | Returns the ratio of the resolution in physical pixels to the resolution in CSS pixels for the current display device.<br/>This value could also be interpreted as the ratio of pixel sizes: the size of one CSS pixel to the size of one physical pixel. In simpler terms, this tells the browser how many of the screen's actual pixels should be used to draw a single CSS pixel.<br/>Page zooming affects the value of devicePixelRatio. When a page is zoomed in (made larger), the size of a CSS pixel increases, and so the devicePixelRatio value increases. Pinch-zooming does not affect devicePixelRatio, because this magnifies the page without changing the size of a CSS pixel.<br/>This is useful when dealing with the difference between rendering on a standard display versus a HiDPI or Retina display, which use more screen pixels to draw the same objects, resulting in a sharper image.<br/>You can use *MatchMedia()* to check if the value of devicePixelRatio changes (which can happen, for example, if the user drags the window to a display with a different pixel density). See [the example below](https://developer.mozilla.org/en-US/docs/Web/API/Window/devicePixelRatio#monitoring_screen_resolution_or_zoom_level_changes). |
| ScrollX             | ValueTask&lt;double&gt;        | get     | Returns the number of pixels by which the document is currently scrolled horizontally. This value is subpixel precise in modern browsers, meaning that it isn't necessarily a whole number. You can get the number of pixels the document is scrolled vertically from the *ScrollY* property.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       |
| ScrollY             | ValueTask&lt;double&gt;        | get     | Returns the number of pixels by which the document is currently scrolled vertically. This value is subpixel precise in modern browsers, meaning that it isn't necessarily a whole number. You can get the number of pixels the document is scrolled horizontally from the *ScrollX* property.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       |
| ScreenX             | ValueTask&lt;int&gt;           | get     | Returns the horizontal distance, in CSS pixels, of the left border of the user's browser viewport to the left side of the screen.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   |
| ScreenY             | ValueTask&lt;int&gt;           | get     | Returns the vertical distance, in CSS pixels, of the top border of the user's browser viewport to the top edge of the screen.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       |
| Origin              | ValueTask&lt;string&gt;        | get     | Returns the origin of the global scope, serialized as a string.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     |
| Name                | ValueTask&lt;string&gt;        | get     | Gets/Sets the name of the window's browsing context.<br/>The name of the window is used primarily for setting targets for hyperlinks and forms. Browsing contexts do not need to have names.<br/>Modern browsers will reset Window.name to an empty string if a tab loads a page from a different domain, and restore the name if the original page is reloaded (e.g., by selecting the "back" button). This prevents an untrusted page from accessing any information that the previous page might have stored in the property (potentially the new page might also modify such data, which might then be read by the original page if it was reloaded).                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           |
| Closed              | ValueTask&lt;bool&gt;          | get     | Indicates whether the referenced window is closed or not.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           |
| Credentialless      | ValueTask&lt;bool&gt;          | get     | Indicates whether the current document was loaded inside a credentialless &lt;iframe&gt;, meaning that it is loaded in a new, ephemeral context.<br/>This context doesn't have access to the network, cookies, and storage data associated with its origin. It uses a new context local to the top-level document lifetime. In return, the Cross-Origin-Embedder-Policy (COEP) embedding rules can be lifted, so documents with COEP set can embed third-party documents that do not.<br/>See [IFrame credentialless](https://developer.mozilla.org/en-US/docs/Web/Security/IFrame_credentialless) for a deeper explanation.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        |
| CrossOriginIsolated | ValueTask&lt;bool&gt;          | get     | Indicates whether the document is cross-origin isolated.<br/>A cross-origin isolated document only shares its browsing context group with same-origin documents in popups and navigations, and resources (both same-origin and cross-origin) that the document has opted into using via CORS (and COEP for &lt;iframe&gt;). The relationship between a cross-origin opener of the document or any cross-origin popups that it opens are severed. The document may also be hosted in a separate OS process alongside other documents with which it can communicate by operating on shared memory. This mitigates the risk of side-channel attacks and cross-origin attacks referred to as XS-Leaks.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  |
| IsSecureContext     | ValueTask&lt;bool&gt;          | get     | Indicates whether the current context is secure (true) or not (false).                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              |
| OriginAgentCluster  | ValueTask&lt;bool&gt;          | get     | Returns true if this window belongs to an origin-keyed agent cluster: this means that the operating system has provided dedicated resources (for example an operating system process) to this window's origin that are not shared with windows from other origins.<br/>Otherwise this property returns false.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       |
| Menubar             | ValueTask&lt;bool&gt;          | get     | Returns the menubar object.<br/>This is one of a group of Window properties that contain a boolean visible property, that used to represent whether or not a particular part of a web browser's user interface was visible.<br/>For privacy and interoperability reasons, the value of the visible property is now false if this Window is a popup, and true otherwise.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             |
| FrameElement        | ValueTask&lt;IHTMLElement?&gt; | get     | Returns the element (such as &lt;iframe&gt; or &lt;object&gt;) in which the window is embedded.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     |

#### Methods

| **Name**               | **Parameters**                                                | **ReturnType**                 | **Description**                    |
| ---------------------- | ------------------------------------------------------------- | ------------------------------ | ---------------------------------- |
| GetInnerWidth          | CancellationToken cancellationToken                           | ValueTask&lt;int&gt;           | see Property *InnerWidth*          |
| GetInnerHeight         | CancellationToken cancellationToken                           | ValueTask&lt;int&gt;           | see Property *InnerHeight*         |
| GetOuterWidth          | CancellationToken cancellationToken                           | ValueTask&lt;int&gt;           | see Property *OuterWidth*          |
| GetOuterHeight         | CancellationToken cancellationToken                           | ValueTask&lt;int&gt;           | see Property *OuterHeight*         |
| GetDevicePixelRatio    | CancellationToken cancellationToken                           | ValueTask&lt;double&gt;        | see Property *DevicePixelRatio*    |
| GetScrollX             | CancellationToken cancellationToken                           | ValueTask&lt;double&gt;        | see Property *ScrollX*             |
| GetScrollY             | CancellationToken cancellationToken                           | ValueTask&lt;double&gt;        | see Property *ScrollY*             |
| GetScreenX             | CancellationToken cancellationToken                           | ValueTask&lt;int&gt;           | see Property *ScreenX*             |
| GetScreenY             | CancellationToken cancellationToken                           | ValueTask&lt;int&gt;           | see Property *ScreenY*             |
| GetOrigin              | CancellationToken cancellationToken                           | ValueTask&lt;string&gt;        | see Property *Origin*              |
| GetName                | CancellationToken cancellationToken                           | ValueTask&lt;string&gt;        | see Property *Name*                |
| SetName                | string value, [CancellationToken cancellationToken = default] | ValueTask                      | see Property *Name*                |
| GetClosed              | CancellationToken cancellationToken                           | ValueTask&lt;bool&gt;          | see Property *Closed*              |
| GetCredentialless      | CancellationToken cancellationToken                           | ValueTask&lt;bool&gt;          | see Property *Credentialless*      |
| GetCrossOriginIsolated | CancellationToken cancellationToken                           | ValueTask&lt;bool&gt;          | see Property *CrossOriginIsolated* |
| GetIsSecureContext     | CancellationToken cancellationToken                           | ValueTask&lt;bool&gt;          | see Property *IsSecureContext*     |
| GetOriginAgentCluster  | CancellationToken cancellationToken                           | ValueTask&lt;bool&gt;          | see Property *OriginAgentCluster*  |
| GetMenubar             | CancellationToken cancellationToken                           | ValueTask&lt;bool&gt;          | see Property *Menubar*             |
| GetFrameElement        | CancellationToken cancellationToken                           | ValueTask&lt;IHTMLElement?&gt; | see Property *FrameElement*        |

#### Events

| **Name**                  | **Type**                                   | **Description**         |
| ------------------------- | ------------------------------------------ | ----------------------- |


<br></br>
### IWindowInProcess

#### Properties

| **Name**            | **Type**               | get/set | **Description**                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     |
| ------------------- | ---------------------- | ------- | ------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- |
| InnerWidth          | int                    | get     | Returns the interior width of the window in pixels (that is, the width of the window's layout viewport). That includes the width of the vertical scroll bar, if one is present.<br/>Similarly, the interior height of the window (that is, the height of the layout viewport) can be obtained using the innerHeight property. That measurement also accounts for the height of the horizontal scroll bar, if it is visible.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         |
| InnerHeight         | int                    | get     | Returns the interior height of the window in pixels, including the height of the horizontal scroll bar, if present.<br/>The value of innerHeight is taken from the height of the window's layout viewport. The width can be obtained using the *InnerWidth* property.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               |
| OuterWidth          | int                    | get     | Returns the width of the outside of the browser window. It represents the width of the whole browser window including sidebar (if expanded), window chrome and window resizing borders/handles.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     |
| OuterHeight         | int                    | get     | Returns the height in pixels of the whole browser window, including any sidebar, window chrome, and window-resizing borders/handles.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                |
| DevicePixelRatio    | double                 | get     | Returns the ratio of the resolution in physical pixels to the resolution in CSS pixels for the current display device.<br/>This value could also be interpreted as the ratio of pixel sizes: the size of one CSS pixel to the size of one physical pixel. In simpler terms, this tells the browser how many of the screen's actual pixels should be used to draw a single CSS pixel.<br/>Page zooming affects the value of devicePixelRatio. When a page is zoomed in (made larger), the size of a CSS pixel increases, and so the devicePixelRatio value increases. Pinch-zooming does not affect devicePixelRatio, because this magnifies the page without changing the size of a CSS pixel.<br/>This is useful when dealing with the difference between rendering on a standard display versus a HiDPI or Retina display, which use more screen pixels to draw the same objects, resulting in a sharper image.<br/>You can use *MatchMedia()* to check if the value of devicePixelRatio changes (which can happen, for example, if the user drags the window to a display with a different pixel density). See [the example below](https://developer.mozilla.org/en-US/docs/Web/API/Window/devicePixelRatio#monitoring_screen_resolution_or_zoom_level_changes). |
| ScrollX             | double                 | get     | Returns the number of pixels by which the document is currently scrolled horizontally. This value is subpixel precise in modern browsers, meaning that it isn't necessarily a whole number. You can get the number of pixels the document is scrolled vertically from the *ScrollY* property.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       |
| ScrollY             | double                 | get     | Returns the number of pixels by which the document is currently scrolled vertically. This value is subpixel precise in modern browsers, meaning that it isn't necessarily a whole number. You can get the number of pixels the document is scrolled horizontally from the *ScrollX* property.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       |
| ScreenX             | int                    | get     | Returns the horizontal distance, in CSS pixels, of the left border of the user's browser viewport to the left side of the screen.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   |
| ScreenY             | int                    | get     | Returns the vertical distance, in CSS pixels, of the top border of the user's browser viewport to the top edge of the screen.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       |
| Origin              | string                 | get     | Returns the origin of the global scope, serialized as a string.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     |
| Name                | string                 | get/set | Gets/Sets the name of the window's browsing context.<br/>The name of the window is used primarily for setting targets for hyperlinks and forms. Browsing contexts do not need to have names.<br/>Modern browsers will reset Window.name to an empty string if a tab loads a page from a different domain, and restore the name if the original page is reloaded (e.g., by selecting the "back" button). This prevents an untrusted page from accessing any information that the previous page might have stored in the property (potentially the new page might also modify such data, which might then be read by the original page if it was reloaded).                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           |
| Closed              | bool                   | get     | Indicates whether the referenced window is closed or not.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           |
| Credentialless      | bool                   | get     | Indicates whether the current document was loaded inside a credentialless &lt;iframe&gt;, meaning that it is loaded in a new, ephemeral context.<br/>This context doesn't have access to the network, cookies, and storage data associated with its origin. It uses a new context local to the top-level document lifetime. In return, the Cross-Origin-Embedder-Policy (COEP) embedding rules can be lifted, so documents with COEP set can embed third-party documents that do not.<br/>See [IFrame credentialless](https://developer.mozilla.org/en-US/docs/Web/Security/IFrame_credentialless) for a deeper explanation.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        |
| CrossOriginIsolated | bool                   | get     | Indicates whether the document is cross-origin isolated.<br/>A cross-origin isolated document only shares its browsing context group with same-origin documents in popups and navigations, and resources (both same-origin and cross-origin) that the document has opted into using via CORS (and COEP for &lt;iframe&gt;). The relationship between a cross-origin opener of the document or any cross-origin popups that it opens are severed. The document may also be hosted in a separate OS process alongside other documents with which it can communicate by operating on shared memory. This mitigates the risk of side-channel attacks and cross-origin attacks referred to as XS-Leaks.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  |
| IsSecureContext     | bool                   | get     | Indicates whether the current context is secure (true) or not (false).                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              |
| OriginAgentCluster  | bool                   | get     | Returns true if this window belongs to an origin-keyed agent cluster: this means that the operating system has provided dedicated resources (for example an operating system process) to this window's origin that are not shared with windows from other origins.<br/>Otherwise this property returns false.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       |
| Menubar             | bool                   | get     | Returns the menubar object.<br/>This is one of a group of Window properties that contain a boolean visible property, that used to represent whether or not a particular part of a web browser's user interface was visible.<br/>For privacy and interoperability reasons, the value of the visible property is now false if this Window is a popup, and true otherwise.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             |
| FrameElement        | IHTMLElementInProcess? | get     | Returns the element (such as &lt;iframe&gt; or &lt;object&gt;) in which the window is embedded.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     |

#### Methods

| **Name**               | **Parameters**                                                | **ReturnType**                 | **Description**                    |
| ---------------------- | ------------------------------------------------------------- | ------------------------------ | ---------------------------------- |

#### Events

| **Name**                  | **Type**                                   | **Description**         |
| ------------------------- | ------------------------------------------ | ----------------------- |
